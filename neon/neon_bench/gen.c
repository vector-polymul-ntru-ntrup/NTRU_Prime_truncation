
#include <stdio.h>
#include <stdint.h>
#include <assert.h>
#include <memory.h>

#include "tools.h"
#include "naive_mult.h"

#include "params.h"
#include "NTT_params.h"

#include "ring.h"

#include "rader.h"

#include "polymul.h"

int16_t twiddle_rader17[17] = {
1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080
};

int16_t twiddle_rader17_inv[17] = {
1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152
};

int16_t twiddle_inv_rader17[17] = {
0, 1151, 304, -2148, 1204, 1677, 244, 2188, 1268, 1949, 1400, -2081, 341, -843, -1284, 285, -1081
};

int16_t twist_table[16 * 96] = {
-1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283
};

int16_t twist_inv_table[16 * 96] = {
1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 1, -2147, 245, 1950, 342, 286, 1152, 1205, 2189, 1401, -842, -1080, 305, 1678, 1269, -2080, -1283, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, 1, 245, 342, 1152, 2189, -842, 305, 1269, -1283, -2147, 1950, 286, 1205, 1401, -1080, 1678, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1, 1950, 1152, 1401, 305, -2080, -2147, 342, 1205, -842, 1678, -1283, 245, 286, 2189, -1080, 1269, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1, 342, 2189, 305, -1283, 1950, 1205, -1080, -2080, 245, 1152, -842, 1269, -2147, 286, 1401, 1678, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 1, 286, -842, -2080, 1950, 2189, 1678, -2147, 1152, -1080, -1283, 342, 1401, 1269, 245, 1205, 305, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 1, 1152, 305, -2147, 1205, 1678, 245, 2189, 1269, 1950, 1401, -2080, 342, -842, -1283, 286, -1080, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1, 1205, 1269, 342, -1080, -2147, 2189, -2080, 286, 305, 245, 1401, -1283, 1152, 1678, 1950, -842, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1, 2189, -1283, 1205, -2080, 1152, 1269, 286, 1678, 342, 305, 1950, -1080, 245, -842, -2147, 1401, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1, 1401, -2147, -842, 245, -1080, 1950, 305, 342, 1678, 286, 1269, 1152, -2080, 1205, -1283, 2189, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, 1, -842, 1950, 1678, 1152, -1283, 1401, 245, 305, 286, -2080, 2189, -2147, -1080, 342, 1269, 1205, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 1, -1080, 286, -1283, -842, 342, -2080, 1401, 1950, 1269, 2189, 245, 1678, 1205, -2147, 305, 1152, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, 1, 305, 1205, 245, 1269, 1401, 342, -1283, -1080, 1152, -2147, 1678, 2189, 1950, -2080, -842, 286, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, 1, 1678, 1401, 286, -2147, 1269, -842, 1152, 245, -2080, -1080, 1205, 1950, -1283, 305, 2189, 342, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 1, 1269, -1080, 2189, 286, 245, -1283, 1678, -842, 1205, 342, -2147, -2080, 305, 1401, 1152, 1950, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, 1, -2080, 1678, -1080, 1401, 1205, 286, 1950, -2147, -1283, 1269, 305, -842, 2189, 1152, 342, 245, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147, 1, -1283, -2080, 1269, 1678, 305, -1080, -842, 1401, 2189, 1205, 1152, 286, 342, 1950, 245, -2147
};

int16_t twist_16x6x16_table[16 * 6 * 16] = {
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1
};

int16_t twist_16x6x16_inv_table[16 * 6 * 16] = {
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 310, -311, 1, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1, -311, 310, 1
};

int16_t twist16id[16] = {
1, 1, 1, 1,
1, 1, 1, 1,
1, 1, 1, 1,
1, 1, 1, 1
};

int16_t twist16[16] = {
1, OMEGA3, OMEGA3INV, 1,
OMEGA3, OMEGA3INV, 1, OMEGA3,
OMEGA3INV, 1, OMEGA3, OMEGA3INV,
1, OMEGA3, OMEGA3INV, 1
};

int16_t twist16inv[16] = {
1, OMEGA3INV, OMEGA3, 1,
OMEGA3INV, OMEGA3, 1, OMEGA3INV,
OMEGA3, 1, OMEGA3INV, OMEGA3,
1, OMEGA3INV, OMEGA3, 1
};

void print_int16(int16_t *src, size_t len){

    for(size_t i = 0; i < len; i++){
        printf("%d%s", src[i], (i == len - 1)? ("\n"):(", "));
    }

}

int16_t gethi(int16_t a){

    int16_t scale;

    scale = RmodQ;

    coeff_ring.mulZ(&a, &a, &scale);

    if((a & 1) == 0){
        if(a < 0){
            a += Q;
        }
        if(a > 0){
            a -= Q;
        }
    }

    a *= Qinv;
    a >>= 1;

    return a;

}

void extend_table_int16(int16_t *table_extended, int16_t *table, size_t len){

    for(size_t i = 0; i < len; i++){
        table_extended[2 * i + 0] = table[i];
        table_extended[2 * i + 1] = gethi(table[i]);
    }

}

void permute_table_lohi(int16_t *table, size_t len){

    int16_t buff[len];

    for(size_t i = 0; i < (len / 2); i++){
        buff[i + 0 * (len / 2)] = table[2 * i + 0];
        buff[i + 1 * (len / 2)] = table[2 * i + 1];
    }

    memmove(table, buff, len * sizeof(int16_t));

}

int main(void){

    int16_t twiddle17[17];
    int16_t twiddle_buff[128];
    int16_t twist[16 * 96];
    int16_t twist_extended[2 * 16 * 96];
    int16_t twiddle, t, omega;

// ================

    omega = OMEGA17;
    getExpVec(twiddle17, omega, 17);
    assert(memcmp(twiddle_rader17, twiddle17, 17 * sizeof(int16_t)) == 0);

    rader_17_primitive_twiddle_permute(twiddle_buff, twiddle_rader17);

    for(size_t i = 0; i < 8; i++){
        add_sub(twiddle_buff + i + 0, twiddle_buff + i + 8);
    }
    for(size_t i = 0; i < 4; i++){
        add_sub(twiddle_buff + i + 0, twiddle_buff + i + 4);
    }
    assert(memcmp(twiddle_rader17_permuted, twiddle_buff, 16 * sizeof(int16_t)) == 0);

// ================

    omega = OMEGA17INV;
    getExpVec(twiddle17, omega, 17);
    assert(memcmp(twiddle_rader17_inv, twiddle17, 17 * sizeof(int16_t)) == 0);

    t = 1;
    for(size_t i = 0; i < 17; i++){
        coeff_ring.subZ(twiddle17 + i, twiddle_rader17 + i, &t);
    }
    assert(memcmp(twiddle_inv_rader17, twiddle17, 17 * sizeof(int16_t)) == 0);

    rader_17_primitive_inv_twiddle_permute(twiddle_buff, twiddle_inv_rader17);

    for(size_t i = 0; i < 8; i++){
        add_sub(twiddle_buff + i + 0, twiddle_buff + i + 8);
    }
    for(size_t i = 0; i < 4; i++){
        add_sub(twiddle_buff + i + 0, twiddle_buff + i + 4);
    }

    assert(memcmp(twiddle_irader17_permuted, twiddle_buff, 16 * sizeof(int16_t)) == 0);


// ================

    for(size_t i = 0; i < 16; i++){
        twiddle = twiddle_rader17[i + 1];
        coeff_ring.expZ(&twiddle, &twiddle, 14);
        twist[i * 96 + 0] = 1;
        for(size_t j = 1; j < 96; j++){
            coeff_ring.mulZ(twist + i * 96 + j, twist + i * 96 + (j - 1), &twiddle);
        }
    }
    for(size_t i = 0; i < 16; i++){
        for(size_t j = 0; j < 96; j++){
            coeff_ring.mulZ(twist + i * 96 + j, twist + i * 96 + j, twiddle_rader17_inv + i + 1);
        }
    }
    assert(memcmp(twist_table, twist, 1536 * sizeof(int16_t)) == 0);

    extend_table_int16(twist_extended, twist, 1536);
    for(size_t i = 0; i < 3072; i += 16){
        permute_table_lohi(twist_extended + i, 16);
    }
    assert(memcmp(twist_table_lohi, twist_extended, 3072 * sizeof(int16_t)) == 0);

// ================

    for(size_t i = 0; i < 16; i++){
        twiddle = twiddle_rader17_inv[i + 1];
        coeff_ring.expZ(&twiddle, &twiddle, 14);
        twist[i * 96 + 0] = 1;
        for(size_t j = 1; j < 96; j++){
            coeff_ring.mulZ(twist + i * 96 + j, twist + i * 96 + (j - 1), &twiddle);
        }
    }
    for(size_t i = 0; i < 16; i++){
        for(size_t j = 0; j < 96; j++){
            coeff_ring.mulZ(twist + i * 96 + j, twist + i * 96 + j, twiddle_rader17 + i + 1);
        }
    }
    assert(memcmp(twist_inv_table, twist, 1536 * sizeof(int16_t)) == 0);

    extend_table_int16(twist_extended, twist, 1536);
    for(size_t i = 0; i < 3072; i += 16){
        permute_table_lohi(twist_extended + i, 16);
    }
    assert(memcmp(twist_inv_table_lohi, twist_extended, 3072 * sizeof(int16_t)) == 0);

// ================

    for(size_t i = 0; i < 32 * 48; i += 48){
        memmove(twist + i + 0 * 16,  twist16id, 16 * sizeof(int16_t));
        memmove(twist + i + 1 * 16,    twist16, 16 * sizeof(int16_t));
        memmove(twist + i + 2 * 16, twist16inv, 16 * sizeof(int16_t));
    }
    assert(memcmp(twist_16x6x16_table, twist, 1536 * sizeof(int16_t)) == 0);

    extend_table_int16(twist_extended, twist, 1536);
    for(size_t i = 0; i < 3072; i += 16){
        permute_table_lohi(twist_extended + i, 16);
    }
    assert(memcmp(twist_16x6x16_table_lohi, twist_extended, 1536 * sizeof(int16_t)) == 0);

// ================

    for(size_t i = 0; i < 32 * 48; i += 48){
        memmove(twist + i + 0 * 16,  twist16id, 16 * sizeof(int16_t));
        memmove(twist + i + 1 * 16, twist16inv, 16 * sizeof(int16_t));
        memmove(twist + i + 2 * 16,    twist16, 16 * sizeof(int16_t));
    }
    assert(memcmp(twist_16x6x16_inv_table, twist, 1536 * sizeof(int16_t)) == 0);

    extend_table_int16(twist_extended, twist, 1536);
    for(size_t i = 0; i < 3072; i += 16){
        permute_table_lohi(twist_extended + i, 16);
    }
    assert(memcmp(twist_16x6x16_inv_table_lohi, twist_extended, 1536 * sizeof(int16_t)) == 0);



    printf("gen finished!\n");

}


